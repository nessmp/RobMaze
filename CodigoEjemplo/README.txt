Este código no fue el producto final pero tiene gran parte de lo utilizado